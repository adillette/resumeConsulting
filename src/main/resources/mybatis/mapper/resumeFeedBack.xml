<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.yourproject.dao.ResumeFeedbackMapper">
  <insert id="insertFeedback" parameterType="com.example.yourproject.dto.ResumeFeedBack"
  useGeneratedKeys="true" keyProperty="feedbackId">
  INSERT INTO resume_feedbacks (
            resume_id,
            resume_total_score,
            resume_scores,
            resume_strength,
            resume_weakness,
            resume_improvements,
            resume_sentence_feedbacks,
            resume_keyword_analysis,
            resume_career_analysis,
            resume_job_match,
            summary,
            recommended_actions,
            feedback_type
        ) VALUES (
            #{resumeId},
            #{resumeTotalScore},
            #{resumeScores},
            #{resumeStrength},
            #{resumeWeakness},
            #{resumeImprovements},
            #{resumeSentenceFeedbacks},
            #{resumeKeywordAnalysis},
            #{resumeCareerAnalysis},
            #{resumeJobMatch},
            #{summary},
            #{recommended_actions},
            #{feedback_type}
        )



</insert>



    <!-- SELECT: 피드백 조회 (단건) -->
    <select id="selectFeedbackById" parameterType="int" 
            resultType="com.example.yourproject.dto.ResumeFeedBack">
        SELECT 
            feedback_id AS feedbackId,
            //** feedback_id → feedbackId
            
            resume_id AS resumeId,
            //** resume_id → resumeId
            
            resume_total_score AS resumeTotalScore,
            resume_scores AS resumeScores,
            resume_strength AS resumeStrength,
            resume_weakness AS resumeWeakness,
            resume_improvements AS resumeImprovements,
            resume_sentence_feedbacks AS resumeSentenceFeedbacks,
            resume_keyword_analysis AS resumeKeywordAnalysis,
            resume_career_analysis AS resumeCareerAnalysis,
            resume_job_match AS resumeJobMatch,
            summary,
            recommended_actions,
            feedback_type,
            resume_created_at AS resumeCreated_at,
            resume_updated_at AS resumeupdated_at
        FROM resume_feedbacks
        WHERE feedback_id = #{feedbackId}
    </select>
    
    <!-- SELECT: 이력서별 피드백 목록 -->
    <select id="selectFeedbacksByResumeId" parameterType="int" 
            resultType="com.example.yourproject.dto.ResumeFeedBack">
        SELECT 
            feedback_id AS feedbackId,
            resume_id AS resumeId,
            resume_total_score AS resumeTotalScore,
            resume_scores AS resumeScores,
            resume_strength AS resumeStrength,
            resume_weakness AS resumeWeakness,
            resume_improvements AS resumeImprovements,
            resume_sentence_feedbacks AS resumeSentenceFeedbacks,
            resume_keyword_analysis AS resumeKeywordAnalysis,
            resume_career_analysis AS resumeCareerAnalysis,
            resume_job_match AS resumeJobMatch,
            summary,
            recommended_actions,
            feedback_type,
            resume_created_at AS resumeCreated_at,
            resume_updated_at AS resumeupdated_at
        FROM resume_feedbacks
        WHERE resume_id = #{resumeId}
        ORDER BY resume_created_at DESC
    </select>




</mapper>